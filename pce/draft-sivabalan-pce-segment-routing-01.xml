<?xml version="1.0" encoding="US-ASCII"?>
<!DOCTYPE rfc SYSTEM "rfc2629.dtd">
<?rfc toc="yes"?>
<?rfc tocompact="yes"?>
<?rfc tocdepth="3"?>
<?rfc tocindent="yes"?>
<?rfc symrefs="yes"?>
<?rfc sortrefs="yes"?>
<?rfc comments="yes"?>
<?rfc inline="yes"?>
<?rfc compact="yes"?>
<?rfc subcompact="no"?>
<rfc category="std" docName="draft-sivabalan-pce-segment-routing-01.txt" ipr="trust200902">
  <front>
    <title abbrev="PCEP Extensions for Segment Routing">
    PCEP Extensions for Segment Routing</title>

    <author fullname="Siva Sivabalan" initials="S." surname="Sivabalan">
      <organization>Cisco Systems, Inc.</organization>
      <address>
        <postal>
          <street>2000 Innovation Drive</street>
          <city>Kanata</city>
          <region>Ontario</region>
          <code>K2K 3E8</code>
          <country>Canada</country>
        </postal>
        <email>msiva@cisco.com</email>
      </address>
    </author>

    <author fullname="Jan Medved" initials="J." surname="Medved">
      <organization>Cisco Systems, Inc.</organization>
      <address>
        <postal>
          <street>170 West Tasman Dr.</street>
          <city>San Jose</city>
          <region>CA</region>
          <code>95134</code>
          <country>US</country>
        </postal>
        <email>jmedved@cisco.com</email>
      </address>
    </author>
      
    <author fullname="Clarence Filsfils" initials="C." surname="Filsfils">
      <organization>Cisco Systems, Inc.</organization>
      <address>
        <postal>
          <street>Pegasus Parc</street>
          <city>De kleetlaan 6a</city>
          <region>DIEGEM</region>
          <code>BRABANT 1831</code>
          <country>BELGIUM</country>
        </postal>
        <email>cfilsfil@cisco.com</email>
      </address>
    </author>

    <author fullname="Edward Crabbe" initials="E." surname="Crabbe">
      <organization>Google, Inc.</organization>
      <address>
        <postal>
          <street>1600 Amphitheatre Parkway</street>
          <city>Mountain View</city>
          <region>CA</region>
          <code>94043</code>
          <country>US</country>
        </postal>
        <email>edward.crabbe@gmail.com</email>
      </address>
    </author>

    <author fullname="Robert Raszuk" initials="R." surname="Raszuk">
      <organization>NTT I3</organization>
      <address>
        <postal>
          <street>101 S. Ellsworth Ave</street>
          <city>San Mateo</city>
          <region>CA</region>
          <code>94401</code>
          <country>US</country>
        </postal>
        <email>robert@raszuk.net</email>
      </address>
    </author>

    <date day="12" month="July" year="2013" />

    <workgroup>Network Working Group</workgroup>

    <abstract>
      <t>Segment Routing (SR) enables any head-end node to select any path
      without relying on a hop-by-hop signaling technique (e.g., LDP or
      RSVP-TE). It depends only on "segments" that are advertised by Link-State
      Interior Gateway Protocols (IGPs). A Segment Routed Path can be derived
      from a variety of mechanisms, including an IGP Shortest Path Tree (SPT),
      explicit configuration, or a Path Computation Element (PCE).  This
      document specifies extensions to the Path Computation Element Protocol
      (PCEP) that allow a stateful PCE to compute and instantiate Traffic
      Engineering paths, as well as a PCC to request a path subject to certain
      constraint(s) and optimization criteria in SR networks.
      </t>
    </abstract>

    <note title="Requirements Language">
      <t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
      "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
      document are to be interpreted as described in <xref target="RFC2119"/>.
      </t>
    </note>
  </front>

  <middle>
    <section title="Introduction">
      <t>SR technology leverages the source routing and tunneling paradigms. A
      source node can choose a path without relying on hop-by-hop signaling
      protocols such as LDP or RSVP-TE. Each path is specified as a set of
      "segments" advertised by link-state routing protocols (IS-IS or OSPF).
      <xref target="I-D.filsfils-rtgwg-segment-routing"/> provides an
      introduction to SR technology. The corresponding IS-IS and OSPF extensions
      are specified in <xref
      target="I-D.previdi-isis-segment-routing-extensions"/> and <xref
      target="I-D.psenak-ospf-segment-routing-extensions"/>, respectively. Two
      types of segments have been defined; nodal and adjacency segments. A nodal
      segment represents a path to a node, whereas an adjacency segment
      represents a specific adjacency to a node. The SR architecture can be
      applied to MPLS forwarding plane without any change as well as IPv6
      forwarding plane with a new type of routing extension header. A Segment
      Identifier (SID) is a 32-bit value. In the case of the MPLS data plane, an
      SR path corresponds to an MPLS Label Switching Path (LSP)</t>
      
      <t>A Segment Routed path (SR path) can be derived from an IGP Shortest
      Path Tree (SPT). Segment Routed Traffic Engineering paths (SR-TE paths)
      may not follow IGP SPT. Such paths may be chosen by a suitable network
      planning tool and provisioned on the source node of the SR-TE path.</t>

      <t> <xref target="RFC5440"/> describes Path Computation Element Protocol
      (PCEP) for communication between a Path Computation Client (PCC) and a
      Path Control Element (PCE) or between one a pair of PCEs. A PCE computes
      paths for MPLS Traffic Engineering LSPs (MPLS-TE LSPs) based on various
      constraints and optimization criteria. <xref
      target="I-D.ietf-pce-stateful-pce"/> specifies extensions to PCEP that
      allow a stateful PCE to compute and recommend network paths in compliance
      with <xref target="RFC4657"/> and defines objects and TLVs for MPLS-TE
      LSPs. Stateful PCEP extensions provide synchronization of LSP state
      between a PCC and a PCE or between a pair of PCEs, delegation of LSP
      control, reporting of LSP state from a PCC to a PCE, controlling the setup
      and path routing of an LSP from a PCE to a PCC. Stateful PCEP extensions
      are intended for an operational model in which LSPs are configured on the
      PCC, and control over them is delegated to the PCE.</t>

      <t>A mechanism to dynamically instantiate LSPs on a PCC based on the
      requests from a stateful PCE or a controller using stateful PCE is
      specified in <xref target="I-D.crabbe-pce-pce-initiated-lsp"/>. Such
      mechanism is useful in Software Driven Networks (SDN) applications, such
      as demand engineering, or bandwidth calendaring.</t>

      <t>It is possible to use a stateful PCE for computing one or more SR-TE
      paths taking into account various constraints and objective functions.
      Once a path is chosen, the stateful PCE can instantiate an SR-TE path on
      the PCC using PCEP extensions specified in <xref
      target="I-D.crabbe-pce-pce-initiated-lsp"/> along with the SR specific
      PCEP extensions provided in this document. Similarly, a PCC can request an
      SR path from either stateful or a stateless PCE.</t>

    </section>

    <section title="Terminology">

      <t>The following terminologies are used in this document:

      <list style="hanging">

        <t hangText="ERO:"> Explicit Route Object</t>
        <t hangText="IGP:"> Interior Gateway Protocol</t>
        <t hangText="IS-IS:"> Intermediate System to Intermediate System</t>
        <t hangText="LSR:"> Label Switching Router</t>
        <t hangText="MSD:"> Maximum SID Depth</t>
        <t hangText="NAI:"> Node or Adjacency Identifier</t>
        <t hangText="OSPF:"> Open Shortest Path First</t>
        <t hangText="PCC:"> Path Computation Client</t>
        <t hangText="PCE:"> Path Computation Element</t>
        <t hangText="PCEP:"> Path Computation Element Protocol</t>
        <t hangText="RRO:"> Record Route Object</t>
        <t hangText="SID:"> Segment Identifier</t>
        <t hangText="SR:"> Segment Routing</t>
        <t hangText="SR-ERO:"> Segment Routed Explicit Route Object</t>
        <t hangText="SR Path:"> Segment Routed Path</t>
        <t hangText="SR-RRO:"> Segment Routed Record Route Object</t>
        <t hangText="SR-TE Path:"> Segment Routed Traffic Engineering Path</t>

      </list>
      </t>

    </section>

    <section anchor="Operation-Overview" title="Overview of PCEP Operation in SR Networks">

      <t>In SR networks, an ingress node of an SR path appends all outgoing
      packets with an SR header consisting of a list of Segment IDs (SIDs). The
      header has all necessary information to guide the packets from the ingress
      node to the egress node of the path, and hence there is no need for any
      signaling protocol. A SID can represent a nodal segment representing a
      path to a node or adjacency segment representing path over a specific
      adjacency.</t>

      <t>In a PCEP session, path information is carried in the Explicit Route
      Object (ERO), which consists of a sequence of subobjects. Various types of
      ERO subobjects have been specified in <xref target="RFC3209"/>, <xref
      target="RFC3473"/>, and <xref target="RFC3477"/>. In SR networks, a PCE
      needs to specify ERO containing SIDs, and a PCC should be capable of
      processing such ERO. An ERO containing SIDs can be included in the Path
      Computation LSP Initiate Request message (PCInitiate) defined in <xref
      target="I-D.crabbe-pce-pce-initiated-lsp"/>, as well as in the Path
      Computation LSP Update Request (PCUpd) and Path Computation LSP State
      Report (PCRpt) messages defined in Report (PCRpt) messages defined in
      <xref target="I-D.ietf-pce-stateful-pce"/>.</t>

      <t>When a PCEP session between a PCC and a PCE is established, both PCEP
      Speakers exchange information to indicate their ability to support
      SR-specific functionality. A PCEP session can carry EROs of different
      types. However, an ERO carrying SIDs MUST NOT include any other form of
      EROs, i.e., all subobjects within an ERO MUST represent SID. Furthermore,
      if an SR path is established using SR-ERO, subsequent PCEP Update and
      Report messages for that path MUST NOT contain other ERO types. This
      document specifies new error codes to handle these errors. Should the need
      to change the ERO type arise, the SR path must be deleted and re-created
      using a new ERO type.</t>

      <t>A PCC MAY include an ERO object in a PCRpt message. In SR networks, a
      PCC MAY learn the SR actual path actually taken by data packets and report
      that path to a PCE. Methods used by a PCC to learn SR-TE paths are outside
      the scope of this document.</t>

      <t>In summary, this document:

      <list style="symbols">
        <t>Defines a new PCEP capability, new subobjects, a new TLV, and new
        PCEP error codes</t>

        <t>Specifies how two PCEP Speakers can establish a PCEP session that can
        cary segment routing paths</t>

        <t>Defines the formats of SR-specific PCEP messages in Backus-Naur Format
        (BNF).</t>
      </list>
      </t>

      <t>This document specifies SR extensions for the stateless PCE model
      defined in <xref target="RFC5440"/>, as well as for the active stateful and
      passive stateful PCE models defined in <xref
      target="I-D.ietf-pce-stateful-pce"/>.</t>

    </section>

    <section anchor="messages" title="SR-Specific PCEP Message Extensions">
      
      <t>As defined in <xref target="RFC5440"/>, a PCEP message consists of a
      common header followed by a variable length body made up of mandatory
      and/or optional objects. PCEP messages an their formats for stateless PCE
      are defined in <xref target="RFC5440"/>. PCEP messages and their formats
      for stateful PCE are defined in <xref
      target="I-D.ietf-pce-stateful-pce"/>. Finally, PCEP messages and their
      formats for PCE-initiated LSP instantiation are defined in <xref
      target="I-D.crabbe-pce-pce-initiated-lsp"/>.</t>

      <t>This document defines changes to PCEP messages and their formats
      required to carry SR-specific information.</t>
    
      <section anchor="PCReq" title="The PCReq Message">

        <t>This document does not specify any changes to the PCReq message
        format. This document proposes a new optional TLV carried in the RP
        Object (<xref target="PATH-TYPE-TLV"/>), which can be used by a PCC to
        request path computation for one or more SR TE Paths.</t>
      </section>

      <section anchor="PCRep" title="The PCRep Message">

        <t>This document defines the format of the PCRep message carrying SR TE
        Paths. The message is sent by a PCE to a PCC in response to a previously
        received PCReq message, where the PCC requested computation of SR TE
        Paths. The format of the SR-specific PCRep message is as follows:</t>

        <figure>
          <artwork><![CDATA[
   <PCRep Message> ::= <Common Header>
                       <response-list>
Where:

   <response-list>::=<response>[<response-list>]

   <response> ::= <RP> 
                  [<NO-PATH>]   
                  [<path-list>]
 
Where:
    <path-list>::=<SR-ERO>[<path-list>]
          ]]></artwork>
        </figure>

        <t>The RP and NO-PATH Objects are defined in <xref
        target="RFC5440"/>. The &lt;SR-ERO> object contains the SR TE path and
        is defined in <xref target="SR-ERO"/>.</t>
      </section>

      <section anchor="PCCreate" title="The PCInitiate Message">

        <t>The format of the PCInitiate message is as follows:</t>

        <figure>
          <artwork><![CDATA[
   <PCInitiate Message> ::= <Common Header>
                            <PCE-initiated-lsp-list>
Where:

   <PCE-initiated-lsp-list> ::= 
              <PCE-initiated-lsp-request>[<PCE-initiated-lsp-list>]

   <PCE-initiated-lsp-request> ::= <SRP>
                                   <LSP>
                                   <SR-ERO>
          ]]></artwork>

        </figure>

        <t>The &lt;SR-ERO> object contains the SR TE path and is defined in
        <xref target="SR-ERO"/>. The &lt;LSP> object in the Common Header MUST
        include the SYMBOLIC-PATH-NAME TLV.</t>

      </section>

      <section anchor="PCRpt" title="The PCRpt Message">

        <t>An SR-specific PCRpt message is sent by a PCC to a PCE to report the
        current state of an SR TE Path. A PCRpt message can carry more than one
        LSP State Report, but all LSP State reports in the SR-Specific PCRpt
        message MUST be for SR TE Paths. A PCC can send an LSP State Report
        either in response to an LSP Update Request from a PCE, or
        asynchronously when the state of an SR TE Path changes.</t>

        <t>The format of the SR-specific PCRpt message is as follows:</t>

        <figure>
          <artwork><![CDATA[
   <PCRpt Message> ::= <Common Header>
                       <state-report-list>
Where:

   <state-report-list> ::= <state-report>[<state-report-list>]

   <state-report> ::= <SRP> 
                      <LSP>   
                      <sr-te-path>   
 
Where:
    <sr-te-path> ::= <SR-ERO>
          ]]></artwork>
        </figure>

        <t>The &lt;SR-ERO> object contains the actual SR TE path used by the PCC
        and is defined in <xref target="SR-ERO"/>. The actual SR TE Path may be
        different from the programmed SR TE Path, for example, when the
        programmed SR TE Path contains loose hops and the PCC must compute the
        path between loose hops locally.</t>
        
        <t>The &lt;SRP> and &lt;LSP> objects are defined in <xref
        target="I-D.ietf-pce-stateful-pce"/>. The &lt;LSP> object MUST include the
        SYMBOLIC-PATH-NAME TLV. The LSP-sig-type filed in the LSP object MUST be
        set to TBD (Segment Routing).</t>
      </section>

      <section anchor="PCUpd" title="The PCUpd Message">
        
        <t>An SR-Specific PCUpd message is sent by a PCE to a PCC to update an
        SR TE Path. A PCUpd message can carry more than one LSP Update
        Request.</t>

        <t>The format of the SR-specific PCUpd message is as follows:
        
        <figure>
          <artwork><![CDATA[
   <PCUpd Message> ::= <Common Header>
                       <udpate-request-list>
Where:

   <update-request-list> ::= <update-request>[<update-request-list>]

   <update-request> ::= <SRP>
                        <LSP>
                        <sr-te-path>
Where:
   <sr-te-path>::= <SR-ERO>
          ]]></artwork>
        </figure>
        </t>

        <t>The &lt;SR-ERO> object contains the SR TE path computed by the PCE,
        and is defined in <xref target="SR-ERO"/>. The &lt;SRP> and &lt;LSP>
        objects are defined in <xref target="I-D.ietf-pce-stateful-pce"/>. The
        LSP object MUST include the SYMBOLIC-PATH-NAME TLV. The LSP-sig-type
        filed in the LSP object MUST be set to TBD (Segment Routing). Note that
        compared to the RSVP-TE-specific PCUpd message defined in <xref
        target="I-D.ietf-pce-stateful-pce"/>, the path in the SR-specific PCUpd
        message does not have attributes, only hops specified in the &lt;SR-ERO>
        object.</t>

      </section>

    </section>

    <section anchor="object-formats" title="Object Formats">

      <section anchor="open-object-fmt" title="The OPEN Object">
        <t>This document defines a new optional TLV for use in the OPEN
        Object.</t>

        <section anchor="cap-negotiation" title="The SR PCE Capability TLV">

          <t>The SR-PCE-CAPABILITY TLV is an optional TLV for use in the OPEN
          Object to negotiate Segment Routing capability on the PCEP
          session. The format of the SR-PCE-CAPABILITY TLV is shown in the
          following figure:</t>

          <figure anchor="Capability-TLV-Fmt" title="SR-PCE-CAPABILITY TLV format">
            <artwork align="center"><![CDATA[
   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |            Type=TBD           |            Length=4           |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |         Reserved              |     Flags     |      MSD      |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

            ]]></artwork>
          </figure>

          <t>The code point for the TLV type is to be defined by IANA. The TLV
          length is 4 octets.</t>

          <t>The 32-bit value is formatted as follows. The "Maximum SID Depth"
          (1 octet) field (MSD) specifies the maximum number of SIDs that a PCC
          is capable of imposing on a packet. The "Flags" (1 octet) and
          "Reserved" (2 octets) fields are currently unused, and MUST be set to
          zero and ignored on receipt.</t>
      
          <section anchor="SR-CAP-PROCESS" title="Negotiating SR Capability">

            <t>The SR capability TLV is contained in the OPEN object. By
            including the TLV in the OPEN message to a PCE, a PCC indicates its
            support for SR-TE Paths. By including the TLV in the OPEN message to
            a PCC, a PCE indicates that it is capable of computing SR-TE
            paths.</t>

            <t>The number of SIDs that can be imposed on a packet depends on
            PCC's data plane's capability. The default value of MSD is 0 meaning
            that a PCC does not impose any limitation on the number of SIDs
            included in any SR-TE path coming from PCE. Once an SR-capable PCEP
            session is established with a non-default MSD value, the
            corresponding PCE cannot send SR-TE paths with SIDs exceeding the
            MSD value. If a PCC needs to modify the MSD value, the PCEP session
            must be closed and re-established with the new MSD value. If a PCEP
            session is established with a non-default MSD value, and the PCC
            receives an SR-TE path containing more SIDs than specified in the
            MSD value, the PCC MUST send out a PCErr message with Error-Type 10
            (Reception of an invalid object) and Error-value 3 (Unsupported
            number of Segment ERO).</t>

            <t>The SR Capability TLV is meaningful only in the OPEN message sent
            from a PCC to a PCE. As such, a PCE does not need to set MSD value
            in outbound message to a PCC. Similarly, an MSD value received by a
            PCC is ignored. If there are multiple SR capability TLVs, only the
            first TLV is processed.</t>

            <t>All bits in the Reserved and Flags fields SHOULD be set to 0 on
            outbound OPEN messages, and MUST be ignored on inbound OPEN
            messages.</t>
            
          </section>
        </section>
      </section>

      <section anchor="rp-object-fmt" title="The RP Object">
        <t>This document defines a new optional TLV for use in the RP
        Object.</t>

        <section anchor="PATH-TYPE-TLV" title="The LSP-PATH-TYPE TLV">
          <t>A PCC can simultaneously support both RSVP-TE signaled MPLS LSPs as
          well as SR-TE paths. In this case, the PCC needs to query and receive
          paths specified with RSVP-TE EROs (defined in <xref
          target="RFC5440"/>) and paths specified with SR-EROs (defined in this
          document). Thus, there is a need for a PCC to identify the ERO type
          that it wishes to receive from a PCE.</t>

          <t>This document defines a new optional TLV called "LSP-PATH-TYPE"
          that MAY be included in the RP object (defined in <xref
          target="RFC5440"/>) on a PCReq message from a PCC to a PCE. The format
          of this TLV is shown in the following figure:</t>

          <figure anchor="PATH-TYPE-TLV-FORMAT" title="LSP-PATH-TYPE TLV format">
            <artwork align="center"><![CDATA[
   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |           Type= TBD           |            Length=1           |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  | LSP-Path-Type |
  +-+-+-+-+-+-+-+-+

            ]]></artwork>
          </figure>

          <t>The type of the TLV is to be defined by IANA. The TLV length is 1
          octets.</t>

          <t>The 8-bit value contains the Path-Type (PT). The following values for
          Path Type are defined:

          <list style="symbols">
            <t>PT = 0: Requested path is to be used with RSVP-TE signaling
            (default).</t>
            <t>PT = 1: SR-TE path is requested.</t>
          </list>
          </t>

          <t>If this TLV is not included in the PCReq message, the default Path
          Type of 0 is assumed, otherwise the path type specified in the TLV is
          used. An RP object SHOULD carry no more than one LSP-PATH-TYPE TLV,
          only the first is used if several are present, the others are
          ignored.</t>

        </section>
      </section>

      <section anchor="SR-ERO" title="The SR-ERO Object">

        <t>An SR-TE path consists of one or more SID(s) where each SID is
        associated with the identifier that represents the node or adjacency
        corresponding to the SID. This identifier is referred to as the 'Node or
        Adjacency Identifier' (NAI). As described later, a NAI can be
        represented in various formats (e.g., IPv4 address, IPv6 address,
        etc). Furthermore, a NAI is used only for troubleshooting purposes, and
        MUST not be used to replace or modify any fields in a data packet
        header. An SR-ERO object consists of one or more ERO subobjects
        described in the following section.</t>
        
        <section anchor="SR-ERO-SUB" title="The SR-ERO Subobject">
          <t>An SR-ERO subobject consists of a 32-bit header followed by the SID
          and the NAI associated with the SID. The SID is a 32-bit number. The
          size of the NAI depends on its respective type, as described in the
          following sections.</t>

          <figure anchor="SR-ERO-SUBOBJECT" title="SR-ERO Subobject format">
            <artwork><![CDATA[
   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |L|    Type     |     Length    |  ST   |     Flags     |F|S|C|M|
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                              SID                              |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  //                        NAI (variable)                       //
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
           ]]></artwork>
          </figure>

          <t>The fields in the ERO Subobject are as follows: 

          <list style="hanging">

            <t hangText="The 'L' Flag">indicates whether the subobject
            represents a loose-hop in the explicit route <xref
            target="RFC3209"/>. If this flag is unset, a PCC MUST not overwrite
            the SID value present in the SR-ERO subobject. Otherwise, a PCC MAY
            expand or replace one or more SID value(s) in the received SR-ERO
            based on its local policy.<vspace blankLines="1"/></t>
            
            <t hangText="Type">is the type of the SR-ERO Subobject. This
            document defines the SR-ERO Subobject type. A new code point will be
            requested for the SR-ERO Subobject from IANA.<vspace
            blankLines="1"/> </t>

            <t hangText="Length">contains the total length of the subobject in
            octets, including the L, Type and Length fields. Length MUST be at
            least 4, and MUST be a multiple of 4.<vspace blankLines="1"/></t>

            <t hangText="SID Type (ST)">indicates the type of information
            associated with the SID contained in the object body. The SID-Type
            values are described later in this document.
            <vspace blankLines="1"/></t>

            <t hangText="Flags">is used to carry any additional information
            pertaining to SID. Currently, the following flag bits are
            defined:</t>

            <t><list style="symbols">
              <t>M: When this bit is set, the SID value represents an MPLS label
              stack entry as specified in <xref target="RFC5462"/> where only
              the label value is specified by the PCE. Other fields (TC, S, and
              TTL) fields MUST be considered invalid, and PCC MUST set these
              fields according to its local policy and MPLS forwarding
              rules.<vspace blankLines="1"/> </t>

              <t>C: When this bit as well as the M bit are set, then the SID
              value represents an MPLS label stack entry as specified in <xref
              target="RFC5462"/>, where all the entry's fields (Label, TC, S,
              and TTL) are specified by the PCE. However, a PCC MAY choose to
              override TC, S, and TTL values according its local policy and MPLS
              forwarding rules.<vspace blankLines="1"/></t>

              <t>S: When this bit is set, the SID value in the subobject body is
              null. In this case, the PCC is responsible for choosing the SID
              value, e.g., by looking up its Traffic Engineering Database (TED)
              using node/adjacency identifier in the subobject body.<vspace
              blankLines="1"/></t>

              <t>F: When this bit is set, the NAI value in the subobject body is
              null.<vspace blankLines="1"/></t>

            </list>
            </t>
            
            <t hangText="SID">is the Segment Identifier.
            <vspace blankLines="1"/></t>

            <t hangText="NAI">contains the NAI associated with the
            SID. Depending on the value of ST, the NAI can have different format
            as described in the following section.</t>

          </list>
          </t>
        </section>

        <section anchor="SR-ERO-NODAL-32" title="NAI Associated with SID">

          <t>This document defines the following NAIs:
          <list style="hanging">
            <t hangText="'IPv4 Node ID'">is specified as an IPv4 address. In
            this case, ST and Length are 1 and 12 respectively.<vspace
            blankLines="1"/></t>

            <t hangText="'IPv6 Node ID'">is specified as an IPv6 address. In
            this case, ST and Length are 2 and 24 respectively.<vspace
            blankLines="1"/></t>

            <t hangText="'IPv4 Adjacency'">is specified as a pair of IPv4
            addresses. In this case, ST and Length are 3 and 16, respectively,
            and the format of the NAI is shown in the following figure:

            <figure anchor="ADJ-SID-ERO-SUBOBJECT-32" title="NAI for IPv4 Adjacency">
              <artwork><![CDATA[
   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                      Local IPv4 address                       |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                     Remote IPv4 address                       |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
               ]]></artwork>
            </figure>
            <vspace blankLines="1"/>
            </t>

            <t hangText="'IPv6 Adjacency'">is specified as a pair of IPv6
            addresses. In this case, ST and Length are 4 and 40 respectively,
            and the format of the NAI is shown in the following figure:

            <figure anchor="ADJ-SID-ERO-SUBOBJECT-128" title="NAI for IPv6 adjacency">
            <artwork><![CDATA[
   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  //               Local IPv6 address (16 bytes)                 //
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  //               Remote IPv6 address (16 bytes)                //
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
               ]]></artwork>
            </figure>
            <vspace blankLines="1"/>
            </t>

            <t hangText="'Unnumbered Adjacency with IPv4 NodeIDs'">is specified
            as a pair of Node ID / Interface ID tuples. In this case, ST and
            Length are 5 and 24 respectively, and the format of the NAI is shown
            in the following figure:
            <figure anchor="ADJ-SID-ERO-UNNUM-32" title="NAI for Unnumbered adjacency with IPv4 Node IDs">
              <artwork><![CDATA[
   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                      Local Node-ID                            |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                    Local Interface ID                         |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                      Remote Node-ID                           |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                   Remote Interface ID                         |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
               ]]></artwork>
            </figure>
            </t>
          </list>
          </t>

          <t>We are yet to decide if another SID subobject is required for
          unnumbered adjacency with 128 bit node ID.</t>

        </section>

        <section anchor="SR-ERO-PROCESS" title="SR-ERO Processing">

          <t>A PCEP Speaker that does not recognize the new ERO subobject in the
          PCCreate, PCUpd or PCRpt message MUST reject the entire PCEP message
          and MUST send a PCE error message with Error-Type=3 ("Unknown Object")
          and Error-Value=2 ("Unrecognized object Type") or Error-Type=4 ("Not
          supported object") and Error-Value=2 ("Not supported object Type"),
          defined in <xref target="RFC5440"/>.</t>
          
          <t>When the SID represents an MPLS label (i.e. the M bit is set), its
          value (20 most significant bits) MUST be larger than 15, unless it is
          special purpose label, such as an Entropy Label Indicator (ELI) or an
          Entropy Label (EL). If a PCEP Speaker receives a label ERO subobject
          with an invalid value, it MUST send the PCE error message with
          Error-Type = "Reception of an invalid object" and Error-Value = "Bad
          label value". If both M and C bits of an ERO subobject are set, and if
          a PCEP Speaker finds erroneous setting in one or more of TC, S, and
          TTL fields, it MUST send a PCE error with Error-Type = "Reception of
          an invalid object" and Error-Value = "Bad label format".</t>

          <t>If a PCC receives a stack of SR-ERO subobjects, and the number of
          stack exceeds the maximum number of SIDs that the PCC can impose on
          the packet, it MAY send a PCE error with Error-Type = "Reception of an
          invalid object" and Error-Value = "Unsupported number of Segment ERO
          subobjects".</t>

        </section>
      </section>
    </section>


    <section anchor="Backward" title="Backward Compatibility">
      
      <t>An LSR that does not support the SR PCEP capability negotiation cannot
      recognize the SR-ERO subobjects. As such, it shall send a PCEP error with
      Error-Type = 4 (Not supported object) and Error-Value = 2 (Not supported
      object Type) as per <xref target="RFC5440"/>.</t>

    </section>

    <section anchor="Management" title="Management Considerations">

      <section anchor="mgmt-policy" title="Policy">

        <t>PCEP implementation:</t>

        <t><list style="symbols">
 
          <t>Can enable SR-PCEP capability either by default or via explicit
          configuration.</t>

          <t>May generate PCEP error due to unsupported number of SR-ERO
          subobjects either by default or via explicit configuration.</t>

        </list></t>

      </section>

      <section anchor="mgmt-data" title="The PCEP Data Model">
        <t>A PCEP MIB module is defined in <xref
        target="I-D.ietf-pce-pcep-mib"></xref> needs be extended to cover
        additional functionality provided by <xref target="RFC5440"/> and <xref
        target="I-D.crabbe-pce-pce-initiated-lsp"/>. Such extension will cover
        the new functionality specified in this document.</t>
      </section>

    </section>

    <section anchor="Security" title="Security Considerations">

      <t>The security considerations described in <xref target="RFC5440"/> and
      <xref target="I-D.crabbe-pce-pce-initiated-lsp"/> are applicable to this
      specification. No additional security measure is required.</t>
 
    </section>

    <section anchor="IANA" title="IANA Considerations">

      <section anchor="PCEP-Object-Codepoints" title="PCEP Objects">
        
        <t>IANA is requested to allocate a ERO subobject type (recommended value
        = 5) for the SR-ERO subobject.</t>

        <section anchor="LSP-SIG-TYPE" title="LSP-SIG-TYPE field in the LSP object">
          <?rfc subcompact="no"?>
          <t>This document requests that a new value is allocated for Segment
          Routing LSP Type in the LSP-SIG_TYPE registry. </t>
          
          <texttable anchor="LSP-SIG-TYPE-val" style="none" suppress-title="true">
            <ttcol align="center" width='20%'>Value</ttcol>
            <ttcol align="left" width='40%'>Meaning </ttcol>
            <c>1</c><c>&nbsp;Segment Routing </c>
          </texttable>
        </section>
      </section>

      <section anchor="PCEP-Error-Object" title="PCEP-Error Object">
        <t>This document defines new Error-Type and Error-Value for the
        following new conditions:

        <vspace blankLines="1" /> 
        
        <?rfc subcompact="yes"?>

        <list style="hanging" hangIndent="13">

          <t hangText=" Error-Type">Meaning</t>

          <t hangText="    10">Reception of an invalid object
          <list style="hanging" hangIndent="17">
            <t hangText=" Error-value=2:">Bad label value</t>
            <t hangText=" Error-value=3:">Unsupported number of Segment ERO
            subobjects</t>
          </list>
          </t>
        </list>
        </t>
      </section>

      <section anchor="PCEP-TLV-Type-Indicators" title="PCEP TLV Type Indicators">
        <t>This document defines the following new PCEP TLVs:</t>

        <texttable anchor="PCEP-New-TLV-CP" style="none" suppress-title="true">
          <ttcol align="center" width='20%'>Value</ttcol>
          <ttcol align="left" width='40%'>Meaning </ttcol>
          <ttcol align="left" width='40%'>Reference </ttcol>
          <c>--------</c><c>------------------------------------</c><c>-----------------</c>
          <c>26</c><c>&nbsp;SR-PCE-CAPABILITY</c><c>&nbsp;This document</c>
          <c>27</c><c>&nbsp;LSP-PATH-TYPE</c><c>&nbsp;This document</c>
        </texttable>

        <section anchor="LSP-PATH-TYPE" title="LSP-PATH-TYPE Indicators">
          <?rfc subcompact="no"?>
          <t>This document requests that a registry is created to manage the value
          of the LSP-Path-Type field in the LSP object, which defines the technology
          of the LSP path. </t>
          
          <texttable anchor="LSP-PATH-TYPE-val" style="none" suppress-title="true">
            <ttcol align="center" width='20%'>Value</ttcol>
            <ttcol align="left" width='40%'>Meaning </ttcol>
            <c>0</c><c>&nbsp;RSVP </c>
            <c>1</c><c>&nbsp;Segment Routing </c>
          </texttable>
        </section>
      </section>

    </section>

    <section anchor="Contributors" title="Contributors">

      <?rfc subcompact="yes"?>
      <t>The following people contributed to this document:
      <list style="empty">
        <t>- Lakshmi Sharma (Cisco Systems)</t>
      </list>
      </t>
      <?rfc subcompact="no"?>
    </section>

    <section anchor="Acknowledgement" title="Acknowledgements">

      <t>We'd like to thank Ina Minei and George Swallow for valuable comments.</t>
      
    </section>

 </middle>

 <back>
   <references title="Normative References">

     <?rfc include="http://xml.resource.org/public/rfc/bibxml/reference.RFC.2119.xml"?>
     <?rfc include="http://xml.resource.org/public/rfc/bibxml/reference.RFC.5440.xml"?>
     <?rfc include="http://xml.resource.org/public/rfc/bibxml/reference.RFC.5462.xml"?>

     <?rfc include="http://xml.resource.org/public/rfc/bibxml3/reference.I-D.draft-filsfils-rtgwg-segment-routing-00.xml"?>

     <?rfc include="http://xml.resource.org/public/rfc/bibxml3/reference.I-D.draft-psenak-ospf-segment-routing-extensions-01.xml"?>

     <?rfc include="http://xml.resource.org/public/rfc/bibxml3/reference.I-D.draft-previdi-isis-segment-routing-extensions-01.xml"?>
     <?rfc include="http://xml.resource.org/public/rfc/bibxml3/reference.I-D.draft-ietf-pce-stateful-pce-05.xml"?>
     <?rfc include="http://xml.resource.org/public/rfc/bibxml3/reference.I-D.draft-crabbe-pce-pce-initiated-lsp-01.xml"?>
     <?rfc include="http://xml.resource.org/public/rfc/bibxml3/reference.I-D.draft-ietf-pce-pcep-mib-04.xml"?>
     

   </references>

   <references title="Informative References">
     
     <?rfc include="http://xml.resource.org/public/rfc/bibxml/reference.RFC.4657.xml"?>
    <?rfc include="http://xml.resource.org/public/rfc/bibxml/reference.RFC.3209.xml"?>
    <?rfc include="http://xml.resource.org/public/rfc/bibxml/reference.RFC.3473.xml"?>
<?rfc include="http://xml.resource.org/public/rfc/bibxml/reference.RFC.3477.xml"?>

   </references>
  </back>

</rfc>
